rollup-ts-sass-template

##### this is rollup typescript sass template

### åˆå§‹åŒ–

```bash
npm init
```

æ¥ç€æŒ‰ç…§æ­¥éª¤å¡«å…¥ä¿¡æ¯ï¼Œç”Ÿæˆ*package.json*ï¼Œé»˜è®¤å…¥å£ä¸º*main.js*ï¼Œæš‚æ—¶å†™æˆ*main.js*ï¼Œåé¢ä¼šä¿®æ”¹å…¥å£æ–‡ä»¶ä¸ºç¼–è¯‘åçš„æ–‡ä»¶


åœ¨æ ¹ç›®å½•æ–°å»º*src*æ–‡ä»¶å¤¹ï¼Œåœ¨*src*æ–‡ä»¶å¤¹ä¸‹æ–°å»º*main.ts*æ–‡ä»¶ï¼š


```typescript
export function hello () { 
    console.log('hello indeex') 
}
```


### é…ç½®rollup


å®‰è£…*typescript*ã€*rollup*ï¼š

```bash
npm i -D typescript

npm i -S rollup
```


### é…ç½®eslint


å®‰è£…*eslint*ï¼š

```bash
npm i -D eslint
``` 

ç”Ÿæˆeslinté…ç½®æ–‡ä»¶ï¼ˆè¿™ä¸ªè¿‡ç¨‹æœ‰ç‚¹é•¿ğŸ˜ï¼‰ï¼š

```bash
./node_modules/.bin/eslint --init
```

æç¤ºéœ€è¦ï¼š

```bash
Need to install the following packages:
  @eslint/create-config
```


ç¡®è®¤åæ ¹æ®éœ€æ±‚é€‰æ‹©ä¸åŒé…ç½®ï¼Œæœ‰ä¸‰ä¸­é…ç½®ï¼š


```bash
? How would you like to use ESLint? â€¦ 
  To check syntax only
  To check syntax and find problems
â¯ To check syntax, find problems, and enforce code style
```


é€‰æ‹©*To check syntax, find problems, and enforce code styleï¼ˆæ£€æŸ¥è¯­æ³•æ ¼å¼ã€æŸ¥æ‰¾é—®é¢˜ã€ç»Ÿä¸€ä»£ç é£æ ¼ï¼‰*ï¼Œè¯¦ç»†è§„åˆ™é…ç½®è§[eslintæ–‡æ¡£](https://eslint.org/)å’Œ[tslintæ–‡æ¡£](https://typescript-eslint.io/)


æ¥ç€æœ‰ä¸‰ç§ä¸åŒæ¨¡å¼ï¼š

```bash
? What type of modules does your project use? â€¦ 
â¯ JavaScript modules (import/export)
  CommonJS (require/exports)
  None of these
```

é€‰æ‹©*JavaScript modules (import/export)*


æ¥ç€æ˜¯åº“çš„é€‰æ‹©ï¼š


```bash
? Which framework does your project use? â€¦ 
  React
  Vue.js
â¯ None of these
```


æ ¹æ®éœ€æ±‚é€‰æ‹©ç›¸åº”åº“ï¼Œä¹Ÿå¯ä»¥ä¸ä½¿ç”¨åº“ï¼ŒåæœŸå†é…ç½®ï¼Œæ¯”å¦‚åæœŸé…ç½®ä½¿ç”¨*svelte*åº“



æ¥ç€é€‰æ‹©ç¼–ç¨‹è¯­è¨€ï¼š

```bash
? Does your project use TypeScript? â€º No / Yes
```

é€‰æ‹©*Yes*ã€‚*Yes*ä½¿ç”¨Typescriptï¼Œ*No*ä½¿ç”¨Javascriptï¼ˆECMA 262å³ECMAScriptï¼‰



æ¥ç€é€‰æ‹©è¿è¡Œç¯å¢ƒï¼š


```bash
? Where does your code run? â€¦  (Press <space> to select, <a> to toggle all, <i> to invert selection)
âœ” Browser
âœ” Node
```


é€‰æ‹©*Browser*ã€‚ä¹Ÿå¯ä»¥é€‰æ‹©éæµè§ˆå™¨ç¯å¢ƒ



æ¥ç€é€‰æ‹©æ ·å¼ï¼š

```bash
? How would you like to define a style for your project? â€¦ 
  Use a popular style guide
â¯ Answer questions about your style
```


é€‰æ‹©*Answer questions about your style*ï¼Œç”±äºæ˜¯ç©ºé¡¹ç›®ï¼Œè¿™é‡Œä¼šå°‘ä¸€ä¸ªæ£€æµ‹ç°æœ‰é¡¹ç›®å¹¶è‡ªåŠ¨ç”Ÿæˆçš„é€‰é¡¹


æ¥ç€é€‰æ‹©æ ¼å¼åŒ–ä»£ç æ–¹å¼ï¼š

```bash
? What format do you want your config file to be in? â€¦ 
â¯ JavaScript
  YAML
  JSON
```

é€‰æ‹©*JavaScript*


æ¥ç€é€‰æ‹©ä»£ç ç¼©è¿›æ–¹å¼ï¼š

```bash
? What style of indentation do you use? â€¦ 
â¯ Tabs
  Spaces
```

é€‰æ‹©*Tabs*



æ¥ç€é€‰æ‹©å­—ç¬¦ä¸²å•åŒå¼•å·ï¼š

```bash
? What quotes do you use for strings? â€¦ 
  Double
â¯ Single
```

é€‰æ‹©*Single*ã€‚ä¾æ®å›¢é˜Ÿæˆ–ä¸ªäººä¹ æƒ¯é€‰æ‹©ã€‚åŒå¼•å·è¦ä½¿ç”¨*Shift+å•å¼•å·* **ç»„åˆé”®**ï¼Œæ²¡æœ‰å•å¼•å·æŒ‰é”®æ–¹ä¾¿ï¼Œä½†åŒå¼•å·æ˜¯å¾ˆå¤šå›¢é˜Ÿçš„ä»£ç è§„èŒƒ


æ¥ç€æ˜¯å•çº¯çš„è¯¢é—®ä½¿ç”¨çš„æ“ä½œç³»ç»Ÿï¼š

```bash
? What line endings do you use? â€¦ 
â¯ Unix
  Windows
```

é€‰æ‹©*Unix*



ç»“å°¾åŠ ä¸åŠ è‹±æ–‡åˆ†å·ï¼š

```bash
? Do you require semicolons? â€º No / Yes
```

é€‰æ‹©*Yes*



æ¥ç€æ˜¯å•çº¯çš„è¯¢é—®ä½¿ç”¨çš„æ“ä½œç³»ç»Ÿï¼š

```bash
? What line endings do you use? â€¦ 
â¯ Unix
  Windows
```

é€‰æ‹©*Unix*ã€‚æç¤ºéœ€è¦ä¾èµ–ï¼š

```bash
The config that you've selected requires the following dependencies:

eslint-plugin-react@latest @typescript-eslint/eslint-plugin@latest @typescript-eslint/parser@latest
```


æ¥ç€æ˜¯è¯¢é—®è¦ä¸è¦å®‰è£…ï¼š

```bash
? Would you like to install them now? â€º No / Yes
```

é€‰æ‹©*Yes*



æœ€åè¿˜è¦è¯¢é—®ç”¨ä»€ä¹ˆå®‰è£…ï¼š

```bash
? Which package manager do you want to use? â€¦ 
â¯ npm
  yarn
  pnpm
```


å“ªä¸ªå®‰è£…çš„å¿«ç”¨å“ªä¸ªã€‚



é€‰æ‹©åä¼šæ˜¾ç¤ºè¦å®‰è£…çš„ä¾èµ–ï¼š

```bash
Installing eslint-plugin-react@latest, @typescript-eslint/eslint-plugin@latest, @typescript-eslint/parser@latest
```


å®‰è£…å®Œæˆåï¼Œä¼šç”Ÿæˆé…ç½®æ–‡ä»¶*.eslintrc.js*ï¼Œå¹¶è‡ªåŠ¨å¼€å§‹å®‰è£…ç›¸åº”ä¾èµ–ï¼Œè‡ªåŠ¨å®‰è£…å¤±è´¥ï¼Œå°±æ‰‹åŠ¨å®‰è£…ä¸€éä¸Šé¢æç¤ºçš„ä¾èµ–


### é…ç½®å¿½ç•¥æ–‡ä»¶

åœ¨æ ¹ç›®å½•æ–°å»º*.eslintignore*æ–‡ä»¶ï¼š

```javascript
dist/**
node_modules/**
```


åœ¨æ ¹ç›®å½•æ–°å»º*.gitignore*æ–‡ä»¶ï¼š

```javascript
/node_modules

/dist

# production
/build

# misc
.DS_Store

# debug
npm-debug.log*
yarn-debug.log*
yarn-error.log*
.pnpm-debug.log*

# local env files
.env.local
.env.*.local

# typescript
*.tsbuildinfo

# Editor directories and files
.idea
.vscode
*.suo
*.ntvs*
*.njsproj
*.sln
*.sw?
```


### é…ç½®babel


å®‰è£…ä¾èµ–ï¼š

```bash
# åˆ é™¤æ–‡ä»¶ä¾èµ–
npm i -D rimraf

# typescriptç¼–è¯‘ä¾èµ–
npm i -D rollup-plugin-typescript2

# rollupä¾èµ–
npm i -D @rollup/plugin-node-resolve @rollup/plugin-commonjs rollup rollup-plugin-terser

# babelä¾èµ–
npm i -D @babel/core @rollup/plugin-babel @babel/preset-env @babel/plugin-transform-runtime
```


> *@rollup/plugin-commonjs*ä¾èµ–ä¸ºäº†è®©æ‰“åŒ…åçš„è¾“å‡ºæ–‡ä»¶æœ‰*commonjs*ã€*esm(ecmascript module)*ã€*umd*ä¸‰ç§æ¨¡å¼


ä¿®æ”¹*package.json*ï¼š

```json
"main": "./dist/index.js",//rollup.config.jsä¸­è®¾ç½®çš„commonjsæ¨¡å¼æ‰“åŒ…å‡ºçš„æ–‡ä»¶
"module": "./dist/index.esm.js",
"umd": "./dist/index.umd.js",
"types": "./dist/types/index.d.ts",//ç±»å‹å£°æ˜æ–‡ä»¶å…¥å£
```


ä¿®æ”¹*rollup.config.js*æ–‡ä»¶ï¼š


```javascript
/*
 * @Author: indeex
 * @Date: 2019-06-16 21:29:23
 * @Email: indeex@qq.com
 */
import path from 'path'
import resolve from '@rollup/plugin-node-resolve'
import commonjs from '@rollup/plugin-commonjs'
import rollupTypescript from 'rollup-plugin-typescript2'
import babel from '@rollup/plugin-babel'
import { DEFAULT_EXTENSIONS } from '@babel/core'
import { terser } from 'rollup-plugin-terser'
import pkg from './package.json'

const env = process.env.NODE_ENV
const name = "RollupTypescript"

const config = {
    input: path.resolve(__dirname, "src/main.ts"),
    output: [
        //commonjs
        {
            file: pkg.main,
            format: 'cjs',
        },
        //esm
        {
            file: pkg.module,
            format: 'es',
        },
        //umd
        // {
        //     file: pkg.umd,
        //     format: 'umd'
        // },
    ],
    plugins: [
        resolve(),//è§£æç¬¬ä¸‰æ–¹ä¾èµ–
        commonjs(),//è¯†åˆ«commonjå’Œç¬¬ä¸‰æ–¹ä¾èµ–
        rollupTypescript(),//rollupç¼–è¯‘typescript
        babel({
            babelHelpers: 'runtime',//ä½¿ç”¨runtimeç¼–è¯‘åº“
            exclude: 'node_modules/**',
            extensions: [
                ...DEFAULT_EXTENSIONS,
                '.ts',
            ],
        }),
    ],
}

// å¯¹ç”Ÿäº§ç¯å¢ƒè¿›è¡Œä»£ç å‹ç¼©
if (env === 'production') {
    config.plugins.push(terser({
        compress: {
            pure_getters: true,
            unsafe: true,
            unsafe_comps: true,
            warnings: false,
        },
    }))
}

export default config
```



åœ¨æ ¹ç›®å½•ï¼Œæ–°å»º*tsconfig.json*æ–‡ä»¶ï¼š

```bash
{ 
    "compilerOptions": 
        { 
            /* åŸºç¡€é€‰é¡¹ */ 
            "target": "esnext", /* æŒ‡å®š ECMAScript ç›®æ ‡ç‰ˆæœ¬ï¼š'ES3' (default), 'ES5', 'ES2015', 'ES2016', 'ES2017','ES2018' or 'ESNEXT'. */ 
            "module": "esnext", /* è¾“å‡ºçš„ä»£ç ä½¿ç”¨ä»€ä¹ˆæ–¹å¼è¿›è¡Œæ¨¡å—åŒ–ï¼š 'none', 'commonjs', 'amd', 'system', 'umd', 'es2015', or 'ESNext'. */ 
            "lib": [ /* æŒ‡å®šå¼•ç”¨çš„æ ‡å‡†åº“ */ 
                "esnext", 
                "dom", 
                "dom.iterable", 
            ], 
            "allowJs": true,  /* å…è®¸ç¼–è¯‘ js æ–‡ä»¶ */ 
            "removeComments": true, /* è¾“å‡ºä¸åŒ…å«æ³¨é‡Š */ 
            /* ä¸¥æ ¼ç±»å‹æ£€æŸ¥é€‰é¡¹ */ "strict": true, /* å¯ç”¨æ‰€æœ‰ä¸¥æ ¼ç±»å‹æ£€æŸ¥é€‰é¡¹ */ 
            "noImplicitAny": true, /* æ£€æŸ¥éšå« any ç±»å‹çš„è¡¨è¾¾å¼å’Œå£°æ˜ */
            "strictNullChecks": false, /* ä¸¥æ ¼ç©ºæ£€æŸ¥. */ 
            /* é¢å¤–æ£€æŸ¥ */ 
            "noUnusedLocals": true, /* æ£€æŸ¥æ— ç”¨çš„å˜é‡. */ 
            /* Module Resolution Options */ 
            "moduleResolution": "node", /* æŒ‡å®šæ¨¡å—æŸ¥æ‰¾ç­–ç•¥ï¼š 'node' (Node.js) or 'classic' (TypeScript pre-1.6) */ 
            "baseUrl": "./", /* æŸ¥æ‰¾æ¨¡å—çš„åŸºç¡€ç›®å½• */ 
            "paths": { 
                "@/*": [ 
                    "src/*" 
                ] 
            }, /* è®°å½• baseUrl çš„æ¨¡å—è·¯å¾„æŸ¥æ‰¾åˆ«å */ "types": [], /* ç±»å‹å£°æ˜æ–‡ä»¶ */ 
            "allowSyntheticDefaultImports": true,
            "jsx": "preserve"
        },
    "include": [ 
        /* æŒ‡å®šç¼–è¯‘å¤„ç†çš„æ–‡ä»¶åˆ—è¡¨ */ 
        "src/**/*",
        "src/types.ts"
    ],
    "exclude": ["node_modules", "config", "dist", "public"]
}
```




åœ¨æ ¹ç›®å½•ï¼Œæ–°å»º*tsconfig.types.json*æ–‡ä»¶ï¼š

```bash
{ 
    // ç»§æ‰¿ tsconfig.json ä¸­çš„é€šç”¨é…ç½® 
    "extends": "./tsconfig.json", 
    "compilerOptions": { 
        "declaration": true, /* ç”Ÿæˆç›¸åº”çš„ '.d.ts' file. */ 
        "declarationDir": "./dist/types", /* ç±»å‹å£°æ˜æ–‡ä»¶è¾“å‡ºç›®å½• */
        "emitDeclarationOnly": true, /* åªç”Ÿæˆå£°æ˜æ–‡ä»¶ï¼Œä¸ç”Ÿæˆ js æ–‡ä»¶*/ 
        "rootDir": "./src", /* æŒ‡å®šè¾“å‡ºæ–‡ä»¶ç›®å½•ï¼ˆç”¨äºè¾“å‡ºï¼‰ï¼Œç”¨äºæ§åˆ¶è¾“å‡ºç›®å½•ç»“æ„ */ 
    } 
}
```




åœ¨æ ¹ç›®å½•ï¼Œæ–°å»º*babel.config.js*æ–‡ä»¶ï¼š

```javascript
module.exports = { 
    "presets": [ 
        [ 
            "@babel/preset-env", 
            { 
                /* Babel ä¼šåœ¨ Rollup æœ‰æœºä¼šåšå¤„ç†ä¹‹å‰ï¼Œå°†æˆ‘ä»¬çš„æ¨¡å—è½¬æˆ CommonJSï¼Œå¯¼è‡´ Rollup çš„ä¸€äº›å¤„ç†å¤±è´¥ */ 
                "modules": false 
            } 
        ] 
    ], 
    "plugins": [ 
        [ 
            // ä¸ babelHelpers: 'runtime' é…åˆä½¿ç”¨ 
            "@babel/plugin-transform-runtime" 
        ] 
    ] 
}
```

> babel.config.jsä¼šå½±å“æ•´ä¸ªé¡¹ç›®ä¸­çš„ä»£ç ï¼ŒåŒ…å«node_modulesä¸­çš„ä»£ç 
> babelrc åªä¼šå½±å“æœ¬é¡¹ç›®ä¸­çš„ä»£ç ï¼Œæ³¨æ„å¦‚æœè¦ä½¿ç”¨*.babelrc*é…ç½®ï¼Œè¯·åœ¨*src*ä¸‹åˆ›å»º*.babelrc*æ–‡ä»¶



ä¿®æ”¹*package.json*ä¸­*scripts*å­—æ®µå¹¶å¢åŠ *files*å­—æ®µï¼š

```json
"scripts": {
    "clean:dist": "rimraf dist",//æ¸…ç©ºdistæ‰“åŒ…ç›®å½•
    "build:types": "npm run clean:dist && tsc -b ./tsconfig.types.json",//ç¼–è¯‘tsç±»å‹å£°æ˜æ–‡ä»¶
    "build": "npm run build:types && rollup -c",
    "test": "node test/test.js",
    "pretest": "npm run build"//æ‰§è¡Œtestå‘½ä»¤æ—¶ç¦æ­¢è¯¥å‘½ä»¤
},
"files": ["dist"],
```



åœ¨ç»ˆç«¯æµ‹è¯•ï¼š


```bash
npm run build
```

ä¼šç”Ÿæˆ*dist*æ–‡ä»¶å¤¹ï¼Œæ–‡ä»¶å¤¹å†…æœ‰*index.js*æ–‡ä»¶ã€*index.esm.js*æ–‡ä»¶ã€ç±»å‹å£°æ˜æ–‡ä»¶


### test

åœ¨æ ¹ç›®å½•æ–°å»º*test*æ–‡ä»¶å¤¹ï¼Œåœ¨æ–‡ä»¶å¤¹ä¸‹æ–°å»º*test.js*æ–‡ä»¶ï¼š


```javascript
const { hello } = require('../dist/index.js')
hello()
```


åœ¨ç»ˆç«¯æµ‹è¯•ï¼š


```bash
npm run test
```

ä¼šåœ¨ç»ˆç«¯æ‰“å°*hello indeex*



### postcsså’Œé¢„å¤„ç†å™¨

*rollup-plugin-postcss*æ”¯æŒ*Sass*ã€*Less*å’Œ*Stylus*

```bash
# postcss
npm i -D postcss rollup-plugin-postcss

# sass
npm i -D node-sass

# or less
npm i -D less

# or stylus
npm i -D stylus
```


> å¦‚æœå®‰è£…*node-sass*æœ‰é—®é¢˜ï¼Œå¯ä»¥æ›´æ¢å…¶ä»–é¢„å¤„ç†å™¨


ä¿®æ”¹*rollup.config.js*æ–‡ä»¶ï¼š

```javascript
//...
import postcss from 'rollup-plugin-postcss'
import sass from 'node-sass'


//...
plugins: [
    //...
    postcss({
        modules: true,//å¼€å¯css modulesï¼Œ.module.css .module.sss .module.scss .module.sass .module.styl .module.stylus .module.less
        extract: true,
        minimize: productEnv,
        extensions: ['css', 'scss', 'sass'],
        process: processSass,
    }),
],
```



### cssæµè§ˆå™¨è‡ªåŠ¨è¡¥å…¨

```bash
npm i -D autoprefixer
```


ä¿®æ”¹*rollup.config.js*æ–‡ä»¶ï¼š

```javascript
//...
import autoprefixer from 'autoprefixer'


//...
plugins: [
    //...
     postcss({
        //...
        plugins: [
            autoprefixer(),
        ],
    }),
],
```


ä¿®æ”¹*package.json*æ–‡ä»¶ï¼š

```json
//...
"browserslist": [
    "defaults",
    "not ie < 8",
    "last 2 versions",
    "> 1%",
    "iOS 7",
    "last 3 iOS versions"
]
```


### æœ¬åœ°æœåŠ¡å™¨

```bash
npm install -D rollup-plugin-serve
```


ä¿®æ”¹*rollup.config.js*æ–‡ä»¶ï¼š

```javascript
//...
import serve from 'rollup-plugin-serve'

//...
plugins: [
    //...
    serve({
        open: true,
        contentBase: "public",
        host: "localhost",
        port: 9999,
    }),
],
```


åœ¨æ ¹ç›®å½•ä¸‹æ–°å»º*public*æ–‡ä»¶å¤¹ï¼Œåœ¨æ­¤æ–‡ä»¶å¤¹ä¸‹æ–°å»º*index.html*æ–‡ä»¶ï¼Œé…ç½®é¡µé¢ä¸­çš„logo icon


### æ‰“åŒ…html


è¿è¡Œ*npm run build*ä¼šå¯åŠ¨æœ¬åœ°æœåŠ¡å™¨å¹¶æ‰“å¼€æµè§ˆå™¨ï¼Œå¹¶çœ‹åˆ°é¡µé¢ï¼Œä½†æ˜¯é¡µé¢ä¸ä¼šè¢«æ‰“åŒ…åˆ°distæ–‡ä»¶å¤¹ä¸­


```bash
npm i -D rollup-plugin-gen-html
```



ä¿®æ”¹*rollup.config.js*æ–‡ä»¶ï¼š

```javascript
//...
import html from 'rollup-plugin-gen-html'

//...
plugins: [
    //...
    html({
        template: 'public/index.html',
        target: './../dist/index.html',
        hash: productEnv,
        replaceToMinScripts: productEnv
    })
]
```


ä¿®æ”¹*index.html*æ–‡ä»¶ï¼š

```html
<!-- ... -->
<body>
    <div id="root"></div>
    <script src="./index.esm.js"></script>
</body>
<!-- ... -->
```



### å¼€å‘ç¯å¢ƒå’Œç”Ÿäº§ç¯å¢ƒ


å°†*rollup.config.js*çš„*serve*å»æ‰ï¼Œå¹¶åœ¨æ ¹ç›®å½•ä¸‹æ–°å»º*rollup.config.dev.js*æ–‡ä»¶ï¼š

```javascript
import serve from 'rollup-plugin-serve'
import config from './rollup.config'

const indexPath = 'public/index.html'

config.plugins = [
    ...config.plugins,
    serve({
        open: true,
        contentBase: 'public',
        host: 'localhost',
        port: 9999,
        onListening: (server) => {
            const address = server.address()
            const host = address.address === '::' ? 'localhost' : address.address
            const protocol = server.https ? 'https' : 'http'
            console.log(`Server listening at ${protocol}://${host}:${address.port}`)
        }
    }),
]

module.exports = config
```



åœ¨æ ¹ç›®å½•ä¸‹æ–°å»º*rollup.config.prod.js*æ–‡ä»¶ï¼š

```javascript
import config from './rollup.config'

process.env.NODE_ENV = 'production'

config.output.sourcemap = false
config.plugins = [...config.plugins]

module.exports = config
```


å°†æ‰€æœ‰çš„*rollup.config*å¼€å¤´çš„é…ç½®ç§»åŠ¨åˆ°æ ¹ç›®å½•çš„*config*æ–‡ä»¶å¤¹ä¸‹ï¼Œä¿®æ”¹*rollup.config.js*ï¼š

```javascript
//ä¿®æ”¹è·¯å¾„
import pkg from './../package.json'

//ä¿®æ”¹å…¥å£è·¯å¾„
const config = {
    input: path.resolve( path.resolve(__dirname), '..', 'src/main.ts'),
}
```


ä¿®æ”¹*.eslintrc.js*æ–‡ä»¶ï¼š

```javascript
module.exports = {
	//...
	'settings': {
		'react': {
			'version': 'detect'
		}
	}
};
```


ä¿®æ”¹*package.json*æ–‡ä»¶çš„*scripts*å­—æ®µï¼š

```json
 "scripts": {
    "dev": "npm run lint && rollup -w -c ./config/rollup.config.dev.js",
    "clean:dist": "rimraf dist",
    "build:types": "npm run clean:dist && tsc -b ./tsconfig.types.json",
    "build": "npm run build:types && npm run lint && rollup -c ./config/rollup.config.prod.js",
    "test": "node test/test.js",
    "pretest": "npm run build",
    "lint": "eslint --fix --ext .ts,.js src"
},
```


### ä»£ç æ··æ·†

```bash
npm i -D rollup-plugin-uglify
```


ä¿®æ”¹*rollup.config.prod.js*æ–‡ä»¶ï¼š

```javascript
//...
import {uglify} from 'rollup-plugin-uglify'

//...
config.plugins = [...config.plugins, uglify({sourcemap: false})]
```


### çƒ­æ›´æ–°

```bash
npm i -D rollup-plugin-livereload
```


ä¿®æ”¹*rollup.config.dev.js*æ–‡ä»¶ï¼š

```javascript
//...
import livereload from 'rollup-plugin-livereload'

//...
config.plugins = [
    //...
    livereload(),
]
```


### aliasåˆ«å

```bash
npm i -D @rollup/plugin-alias
```


ä¿®æ”¹*rollup.config.js*æ–‡ä»¶ï¼š

```javascript
//...
import alias from '@rollup/plugin-alias'

//...
plugins: [
    //...
    alias({
        entries: [
            {
                find: "@",
                replacement: path.resolve(path.resolve(__dirname), "..", "src"),
            },
            {
                find: "src",
                replacement: path.resolve(path.resolve(__dirname), "..", "src"),
            },
        ],
        customResolver,
    }),
],
```


### ä»£ç æ ¼å¼åŒ–

```bash
npm i -D prettier rollup-plugin-prettier
```


åœ¨æ ¹ç›®å½•ä¸‹æ–°å»º*.prettierrc.js*æ–‡ä»¶ï¼š

```javascript
module.exports = {
    printWidth: 100,
    singleQuote: true,
    trailingComma: 'none',
    bracketSpacing: true,
    bracketSameLine: true,
    tabWidth: 4,
    arrowParens: "always",
}
```


ä¿®æ”¹*rollup.config.js*æ–‡ä»¶ï¼š

```javascript
//...
import prettier from 'rollup-plugin-prettier'
const prettierConfig = path.resolve(path.resolve(__dirname), '..', '.prettierrc.js');

//...
plugins: [
    //...
    prettier(prettierConfig),
],
```


### polyfill

ç”±äº*babel*æ— æ³•è½¬æ¢æ‰€æœ‰æ–°è¯­æ³•ï¼Œå¦‚*Map*ï¼Œéœ€è¦ä½¿ç”¨*babel-polyfill*ï¼š

```bash
npm i -D core-js regenerator-runtime
```



ä¿®æ”¹*babel.config.js*æ–‡ä»¶ï¼š

```javascript
module.exports = {
    "presets": [
        [
            "@babel/preset-env",
            {
                "useBuiltIns": "usage",//æŒ‰éœ€åŠ è½½polyfill
                "corejs": {
                    "version": 3
                },
            }
        ]
    ],
    //...
}
```



å¦‚æœä¸éœ€è¦æ¡†æ¶åŸºæœ¬å®Œæˆäº†ï¼Œå¯ä»¥ç›´æ¥ä½¿ç”¨htmlå’Œç¼–è¯‘çš„jså’Œcssæ–‡ä»¶